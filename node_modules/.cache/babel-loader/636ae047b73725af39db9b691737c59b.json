{"ast":null,"code":"'use strict';\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar CancelError = function (_Error) {\n  (0, _inherits3.default)(CancelError, _Error);\n\n  function CancelError(message) {\n    (0, _classCallCheck3.default)(this, CancelError);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (CancelError.__proto__ || Object.getPrototypeOf(CancelError)).call(this, message));\n\n    _this.name = 'CancelError';\n    return _this;\n  }\n\n  return CancelError;\n}(Error);\n\nvar createDelay = function createDelay(willResolve) {\n  return function (ms, value) {\n    var timeoutId = void 0;\n    var internalReject = void 0;\n    var delayPromise = new Promise(function (resolve, reject) {\n      internalReject = reject;\n      timeoutId = setTimeout(function () {\n        var settle = willResolve ? resolve : reject;\n        settle(value);\n      }, ms);\n    });\n\n    delayPromise.cancel = function () {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n        timeoutId = null;\n        internalReject(new CancelError('Delay canceled'));\n      }\n    };\n\n    return delayPromise;\n  };\n};\n\nmodule.exports = createDelay(true);\nmodule.exports.reject = createDelay(false);\nmodule.exports.CancelError = CancelError;","map":{"version":3,"sources":["/home/amax/Autoro/cabana/node_modules/@commaai/pandajs/lib/delay.js"],"names":["_classCallCheck2","require","_classCallCheck3","_interopRequireDefault","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","obj","__esModule","default","CancelError","_Error","message","_this","__proto__","Object","getPrototypeOf","call","name","Error","createDelay","willResolve","ms","value","timeoutId","internalReject","delayPromise","Promise","resolve","reject","setTimeout","settle","cancel","clearTimeout","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,gBAAgB,GAAGC,OAAO,CAAC,sCAAD,CAA9B;;AAEA,IAAIC,gBAAgB,GAAGC,sBAAsB,CAACH,gBAAD,CAA7C;;AAEA,IAAII,2BAA2B,GAAGH,OAAO,CAAC,iDAAD,CAAzC;;AAEA,IAAII,2BAA2B,GAAGF,sBAAsB,CAACC,2BAAD,CAAxD;;AAEA,IAAIE,UAAU,GAAGL,OAAO,CAAC,gCAAD,CAAxB;;AAEA,IAAIM,UAAU,GAAGJ,sBAAsB,CAACG,UAAD,CAAvC;;AAEA,SAASH,sBAAT,CAAgCK,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEE,IAAAA,OAAO,EAAEF;AAAX,GAArC;AAAwD;;AAE/F,IAAIG,WAAW,GAAG,UAAUC,MAAV,EAAkB;AACnC,GAAC,GAAGL,UAAU,CAACG,OAAf,EAAwBC,WAAxB,EAAqCC,MAArC;;AAEA,WAASD,WAAT,CAAqBE,OAArB,EAA8B;AAC7B,KAAC,GAAGX,gBAAgB,CAACQ,OAArB,EAA8B,IAA9B,EAAoCC,WAApC;;AAEA,QAAIG,KAAK,GAAG,CAAC,GAAGT,2BAA2B,CAACK,OAAhC,EAAyC,IAAzC,EAA+C,CAACC,WAAW,CAACI,SAAZ,IAAyBC,MAAM,CAACC,cAAP,CAAsBN,WAAtB,CAA1B,EAA8DO,IAA9D,CAAmE,IAAnE,EAAyEL,OAAzE,CAA/C,CAAZ;;AAEAC,IAAAA,KAAK,CAACK,IAAN,GAAa,aAAb;AACA,WAAOL,KAAP;AACA;;AAED,SAAOH,WAAP;AACA,CAbiB,CAahBS,KAbgB,CAAlB;;AAeA,IAAIC,WAAW,GAAG,SAASA,WAAT,CAAqBC,WAArB,EAAkC;AACnD,SAAO,UAAUC,EAAV,EAAcC,KAAd,EAAqB;AAC3B,QAAIC,SAAS,GAAG,KAAK,CAArB;AACA,QAAIC,cAAc,GAAG,KAAK,CAA1B;AAEA,QAAIC,YAAY,GAAG,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AACzDJ,MAAAA,cAAc,GAAGI,MAAjB;AAEAL,MAAAA,SAAS,GAAGM,UAAU,CAAC,YAAY;AAClC,YAAIC,MAAM,GAAGV,WAAW,GAAGO,OAAH,GAAaC,MAArC;AACAE,QAAAA,MAAM,CAACR,KAAD,CAAN;AACA,OAHqB,EAGnBD,EAHmB,CAAtB;AAIA,KAPkB,CAAnB;;AASAI,IAAAA,YAAY,CAACM,MAAb,GAAsB,YAAY;AACjC,UAAIR,SAAJ,EAAe;AACdS,QAAAA,YAAY,CAACT,SAAD,CAAZ;AACAA,QAAAA,SAAS,GAAG,IAAZ;AACAC,QAAAA,cAAc,CAAC,IAAIf,WAAJ,CAAgB,gBAAhB,CAAD,CAAd;AACA;AACD,KAND;;AAQA,WAAOgB,YAAP;AACA,GAtBD;AAuBA,CAxBD;;AA0BAQ,MAAM,CAACC,OAAP,GAAiBf,WAAW,CAAC,IAAD,CAA5B;AACAc,MAAM,CAACC,OAAP,CAAeN,MAAf,GAAwBT,WAAW,CAAC,KAAD,CAAnC;AACAc,MAAM,CAACC,OAAP,CAAezB,WAAf,GAA6BA,WAA7B","sourcesContent":["'use strict';\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar CancelError = function (_Error) {\n\t(0, _inherits3.default)(CancelError, _Error);\n\n\tfunction CancelError(message) {\n\t\t(0, _classCallCheck3.default)(this, CancelError);\n\n\t\tvar _this = (0, _possibleConstructorReturn3.default)(this, (CancelError.__proto__ || Object.getPrototypeOf(CancelError)).call(this, message));\n\n\t\t_this.name = 'CancelError';\n\t\treturn _this;\n\t}\n\n\treturn CancelError;\n}(Error);\n\nvar createDelay = function createDelay(willResolve) {\n\treturn function (ms, value) {\n\t\tvar timeoutId = void 0;\n\t\tvar internalReject = void 0;\n\n\t\tvar delayPromise = new Promise(function (resolve, reject) {\n\t\t\tinternalReject = reject;\n\n\t\t\ttimeoutId = setTimeout(function () {\n\t\t\t\tvar settle = willResolve ? resolve : reject;\n\t\t\t\tsettle(value);\n\t\t\t}, ms);\n\t\t});\n\n\t\tdelayPromise.cancel = function () {\n\t\t\tif (timeoutId) {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\ttimeoutId = null;\n\t\t\t\tinternalReject(new CancelError('Delay canceled'));\n\t\t\t}\n\t\t};\n\n\t\treturn delayPromise;\n\t};\n};\n\nmodule.exports = createDelay(true);\nmodule.exports.reject = createDelay(false);\nmodule.exports.CancelError = CancelError;"]},"metadata":{},"sourceType":"script"}