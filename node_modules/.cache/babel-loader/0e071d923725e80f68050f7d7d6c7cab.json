{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.refreshAccessToken = undefined;\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar refreshAccessToken = exports.refreshAccessToken = function () {\n  var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(code, provider) {\n    var resp;\n    return _regenerator2.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return request.postForm('v2/auth/', {\n              code: code,\n              provider: provider\n            });\n\n          case 2:\n            resp = _context.sent;\n\n            if (!(resp.access_token != null)) {\n              _context.next = 8;\n              break;\n            }\n\n            request.configure(resp.access_token);\n            return _context.abrupt('return', resp.access_token);\n\n          case 8:\n            if (!(resp.response !== undefined)) {\n              _context.next = 12;\n              break;\n            }\n\n            throw new Error('Could not exchange oauth code for access token: response ' + resp.response);\n\n          case 12:\n            if (!(resp.error !== undefined)) {\n              _context.next = 16;\n              break;\n            }\n\n            throw new Error('Could not exchange oauth code for access token: error ' + resp.error);\n\n          case 16:\n            console.log(resp);\n            throw new Error('Could not exchange oauth code for access token');\n\n          case 18:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n\n  return function refreshAccessToken(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar _request = require('./request');\n\nvar request = _interopRequireWildcard(_request);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}","map":{"version":3,"sources":["/home/amax/Autoro/cabana/node_modules/@commaai/comma-api/dist/auth.js"],"names":["Object","defineProperty","exports","value","refreshAccessToken","undefined","_regenerator","require","_regenerator2","_interopRequireDefault","_asyncToGenerator2","_asyncToGenerator3","_ref","default","mark","_callee","code","provider","resp","wrap","_callee$","_context","prev","next","request","postForm","sent","access_token","configure","abrupt","response","Error","error","console","log","stop","_x","_x2","apply","arguments","_request","_interopRequireWildcard","obj","__esModule","newObj","key","prototype","hasOwnProperty","call"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.refreshAccessToken = undefined;\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar refreshAccessToken = exports.refreshAccessToken = function () {\n  var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(code, provider) {\n    var resp;\n    return _regenerator2.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return request.postForm('v2/auth/', { code: code, provider: provider });\n\n          case 2:\n            resp = _context.sent;\n\n            if (!(resp.access_token != null)) {\n              _context.next = 8;\n              break;\n            }\n\n            request.configure(resp.access_token);\n            return _context.abrupt('return', resp.access_token);\n\n          case 8:\n            if (!(resp.response !== undefined)) {\n              _context.next = 12;\n              break;\n            }\n\n            throw new Error('Could not exchange oauth code for access token: response ' + resp.response);\n\n          case 12:\n            if (!(resp.error !== undefined)) {\n              _context.next = 16;\n              break;\n            }\n\n            throw new Error('Could not exchange oauth code for access token: error ' + resp.error);\n\n          case 16:\n            console.log(resp);\n            throw new Error('Could not exchange oauth code for access token');\n\n          case 18:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n\n  return function refreshAccessToken(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar _request = require('./request');\n\nvar request = _interopRequireWildcard(_request);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }"]},"metadata":{},"sourceType":"script"}